<!DOCTYPE html>
<html>
<head>
    <title>Books</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

<div class="container">
    <h2 id="title"></h2>
    <div id="bookList" class="grid"></div>
</div>

<script>
const urlParams = new URLSearchParams(window.location.search);
const semester = urlParams.get("semester");
const subject = urlParams.get("subject");

document.getElementById("title").innerText =
    `Semester ${semester} - ${subject}`;

fetch(`/api/books/approved`)
.then(res => res.json())
.then(data => {

    const filteredBooks = data.filter(book =>
        book.semester === semester &&
        book.subject === subject
    );

    const bookList = document.getElementById("bookList");

    if (filteredBooks.length === 0) {
        bookList.innerHTML = "<p>No books available</p>";
        return;
    }

    filteredBooks.forEach(book => {

        const imageUrl = book.image
            ? `/uploads/${book.image}`
            : "https://via.placeholder.com/200x300?text=No+Cover";

       bookList.innerHTML += `
    <div class="book-card">
        <img src="${imageUrl}" />
        <h3>${book.title}</h3>
        <p>${book.author}</p>

        <p><strong>Semester:</strong> ${book.semester}</p>
        <p><strong>Subject:</strong> ${book.subject}</p>

        <a href="${book.driveLink}" target="_blank">
            <button class="btn">Download</button>
        </a>
    </div>
`;
    });
});
</script>

</body>
</html>

